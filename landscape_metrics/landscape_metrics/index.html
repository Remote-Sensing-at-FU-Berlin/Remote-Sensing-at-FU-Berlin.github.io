
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../BFAST/BFAST/">
      
      
        <link rel="next" href="../../spatial_autocorrelation/spatial_autocorrelation/">
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>Calculation of Landscape Metrics from a Land-cover raster map - REMOTE SENSING AND GEOINFORMATICS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="light-green">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#calculation-of-landscape-metrics-from-a-land-cover-raster-map" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="REMOTE SENSING AND GEOINFORMATICS" class="md-header__button md-logo" aria-label="REMOTE SENSING AND GEOINFORMATICS" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            REMOTE SENSING AND GEOINFORMATICS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Calculation of Landscape Metrics from a Land-cover raster map
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Remote-Sensing-at-FU-Berlin/Remote-Sensing-at-FU-Berlin.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Remote-Sensing-at-FU-Berlin.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../qgis/01-GUI/" class="md-tabs__link md-tabs__link--active">
        Prof. Dr. Fassnacht
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../gis/installation/" class="md-tabs__link">
        GIS
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../schuelerpraktikum/handout/" class="md-tabs__link">
        Other
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="REMOTE SENSING AND GEOINFORMATICS" class="md-nav__button md-logo" aria-label="REMOTE SENSING AND GEOINFORMATICS" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    REMOTE SENSING AND GEOINFORMATICS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Remote-Sensing-at-FU-Berlin/Remote-Sensing-at-FU-Berlin.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Remote-Sensing-at-FU-Berlin.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Prof. Dr. Fassnacht
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Prof. Dr. Fassnacht
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          QGIS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          QGIS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../qgis/01-GUI/" class="md-nav__link">
        Getting to know the graphical user interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../qgis/02-vector-data/" class="md-nav__link">
        Loading and visualizing Shapefiles / Vector data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../qgis/03-raster-data/" class="md-nav__link">
        Loading and visualizing raster data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../qgis/04-general-tools/" class="md-nav__link">
        Useful general tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../qgis/05-digitizing/" class="md-nav__link">
        Basic vector processing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../qgis/06-selections/" class="md-nav__link">
        Spatial and semantic selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../qgis/07-elevation/" class="md-nav__link">
        Working with elevation raster datasets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../qgis/08-map-making/" class="md-nav__link">
        Making a map
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../qgis/09-spatial-interpolation/" class="md-nav__link">
        Spatial interpolation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          R
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          R
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../basic-landsat/basic-landsat/" class="md-nav__link">
        Basic Landsat Processing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../random-forest-regression/random-forest-regression/" class="md-nav__link">
        Random Forest Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1_Laserscanning_lidR/1_Laserscanning_lidR/" class="md-nav__link">
        Getting started with processing laserscanning data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../radiative-transfer-model/radiative-transfer-model/" class="md-nav__link">
        Radiative Transfer Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../treespeciesclassification/treespeciesclassification/" class="md-nav__link">
        Classification of tree species using hyperspectral data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BFAST/BFAST/" class="md-nav__link">
        Analysing time series with BFAST and NPPHEN
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Calculation of Landscape Metrics from a Land-cover raster map
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Calculation of Landscape Metrics from a Land-cover raster map
      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datasets-used-in-this-tutorial" class="md-nav__link">
    Datasets used in this Tutorial
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-getting-familiar-with-the-dataset" class="md-nav__link">
    Step 1: Getting familiar with the dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-load-the-land-cover-maps-to-r-and-plot-them" class="md-nav__link">
    Step 2: Load the land cover maps to R and plot them
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-calculate-landscape-metrics-for-the-entire-image" class="md-nav__link">
    Step 3: Calculate landscape metrics for the entire image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-calculate-landscape-metrics-for-a-grid" class="md-nav__link">
    Step 4: Calculate landscape metrics for a grid
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../spatial_autocorrelation/spatial_autocorrelation/" class="md-nav__link">
        Calculating semivariograms and Autocorrelograms
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          GEE
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          GEE
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MSRS_1_GEE_basics/MSRS_1_GEE_basics/" class="md-nav__link">
        Preparing time series data stacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MSRS_1_GEE_basics2/MSRS_1_GEE_basics2/" class="md-nav__link">
        Preparing annual time series data stacks and conducting time series analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
      
      
      
        <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
          SNAP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          SNAP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../planetary-sciences/01-download-ls-and-s2/" class="md-nav__link">
        Download of Landsat and Sentinel satellite images
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          GIS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          GIS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          R
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          R
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gis/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gis/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gis/visualization-and-map/" class="md-nav__link">
        Visualization and Map
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gis/digitalization/" class="md-nav__link">
        Digitalization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gis/attributes-filters-and-metadata/" class="md-nav__link">
        Attributes, Filters and Metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gis/geoprocesing-and-reference-and-coordinate-systems/" class="md-nav__link">
        Geoprocesing and reference and coordinate systems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gis/interpolation/" class="md-nav__link">
        Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gis/dem/" class="md-nav__link">
        Digital Elevation Models
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Other
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../schuelerpraktikum/handout/" class="md-nav__link">
        School internship
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mintoring/mintoring/" class="md-nav__link">
        Mintoring
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/Remote-Sensing-at-FU-Berlin/Remote-Sensing-at-FU-Berlin.github.io/tree/main/docs/landscape_metrics/landscape_metrics.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  


<h1 id="calculation-of-landscape-metrics-from-a-land-cover-raster-map">Calculation of Landscape Metrics from a Land-cover raster map<a class="headerlink" href="#calculation-of-landscape-metrics-from-a-land-cover-raster-map" title="Link zu dieser Sektion">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Link zu dieser Sektion">&para;</a></h2>
<p>In this lecture you will learn how to calculate landscape metrics from a land-cover map saved as a raster file in R. The idea is that you can later use the supervised classification results from the practical of the first day as input to this tutorial. However, for the tutorial itself, a dataset of four land-cover classification maps is provided. More details below.</p>
<p>The learned processing steps include:</p>
<ul>
<li>load the land cover map to R</li>
<li>calculate the landscape metrics for the entire raster image</li>
<li>calculate the landscape metrics for subsets of the image to create a landscape metric map</li>
</ul>
<p>Besides R, we will also use QGIS in this tutorial.  In case you do not have QGIS installed, please download it at <a href="https://qgis.org/en/site/forusers/download.html" title="QGIS">https://qgis.org/en/site/forusers/download.html</a> and install it - this should be straightforward and all the necessary instructions are given on the webpage.</p>
<h2 id="datasets-used-in-this-tutorial">Datasets used in this Tutorial<a class="headerlink" href="#datasets-used-in-this-tutorial" title="Link zu dieser Sektion">&para;</a></h2>
<p>In this tutorial we will use four land-cover maps that were created by a supervised classification. The four maps all show the same area around Karlsruhe with the same five land-use classes and at approximately the same point in time. However, the data from which the maps were derived differ and originate from three different satellite sensors:</p>
<ol>
<li>Sentinel 2: 10 m pixel size</li>
<li>Landsat 8: 30 pixel size</li>
<li>MODIS: 250 m pixel size</li>
<li>MODIS: 500 m pixel size</li>
</ol>
<p>The data are available here:</p>
<p><a href="https://drive.google.com/drive/folders/1LULH7ur_wnZIcxlayWlE0EMbPElrAe0t?usp=sharing" title="Dataset landscape metrics">https://drive.google.com/drive/folders/1LULH7ur_wnZIcxlayWlE0EMbPElrAe0t?usp=sharing</a></p>
<h2 id="step-1-getting-familiar-with-the-dataset">Step 1: Getting familiar with the dataset<a class="headerlink" href="#step-1-getting-familiar-with-the-dataset" title="Link zu dieser Sektion">&para;</a></h2>
<p>We will now first have a look at the data that we are working with. So please download the dataset given at the link above unzip the files and then open the QGIS project by double-clicking the file</p>
<p><strong>overview_results_4_skalen.qgz</strong></p>
<p>Now QGIS should open and show the following:</p>
<p><a class="glightbox" href="../assets/qgis_1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/qgis_1.png" /></a></p>
<p>The QGIS project shows the four land-cover classification maps we will be using in the Tutorial. You can browse through the other three maps by activating the layers in the "Layer" window on the lower left in QGIS. Currently, the data with the highest spatial resolution ("grain") is depicted. If you activate the <strong>mod500_classification</strong> layer, the view in QGIS will look seen below and you can easily see the difference in spatial resolution ("grain") between the two land-cover maps. Despite the grain differences, you can still see that the two maps show roughly the same patterns in terms of land-cover patterns with the big forest area at the center left, larger water areas in the western part of the map and a mosaic of all land-cover classes in the eastern part of the map- </p>
<p><a class="glightbox" href="../assets/qgis_2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/qgis_2.png" /></a></p>
<p>Please have a look also at the two other provided maps which have spatial resolutions between the two depicted datasets. Next, we will load the data into R and start calculating the landscape metrics for the complete image.</p>
<h2 id="step-2-load-the-land-cover-maps-to-r-and-plot-them">Step 2: Load the land cover maps to R and plot them<a class="headerlink" href="#step-2-load-the-land-cover-maps-to-r-and-plot-them" title="Link zu dieser Sektion">&para;</a></h2>
<p>First, we will load all required packages. R will give you a warning message in case a package is not installed yet. If this is the case, please install the packages either through the main
menu of Rstudio by selecting "Tools" =&gt; "Install packages" and then following the appearing dialogue, or by entering the corresponding R code
to install the packages into the console. E.g., to install the package "raster" use the code:</p>
<div class="highlight"><pre><span></span><code>install.packages(&quot;raster&quot;)
</code></pre></div>
<p>After loading the packages by running:</p>
<div class="highlight"><pre><span></span><code># load requires packages
require(raster)
require(SDMTools)
require(doParallel)
require(foreach)
</code></pre></div>
<p>After all packages are successfully installed, we will load the land cover raster maps using two steps. First, change the path to the folder containing the image, then execute the "raster" command to load the image. To check whether you are in the correct folder, you can display all files of the folder using the list.files()-command.
In this case it is important to use the "raster" command instead of the "stack" command due to the input format required by the function we will use to calculate the landscape metrics. </p>
<div class="highlight"><pre><span></span><code>## load land-cover maps derived from S2

# set working directory to the folder where you stored the data for the tutorial
setwd(&quot;E:/Tag2_landscape_metrics/&quot;)
list.files()

# load the land cover classification raster maps
s2_luc &lt;- raster(&quot;s2_classification.tif&quot;)   
ls_luc &lt;- raster(&quot;ls_classification.tif&quot;)
mod250_luc &lt;- raster(&quot;mod250_classification.tif&quot;)
mod500_luc &lt;- raster(&quot;mod500_classification.tif&quot;)
</code></pre></div>
<p>To check whether the data has been loaded correctly, we can briefly plot the four maps using the following commands:</p>
<div class="highlight"><pre><span></span><code># open a new display window
x11()

# change plot settings to plot all four plots in one window using 2 columns and 2 rows
par(mfrow=c(2,2))

# plot the images
plot(s2_luc)
ploz(ls_luc)
plot(mod250_luc)
plot(mod500_luc)
</code></pre></div>
<p>This will result in the following plot:</p>
<p><a class="glightbox" href="../assets/r_0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/r_0.png" /></a></p>
<p>If we prefer to invest a bit more time into the plot to allow for an easier interpretation of the landcover classes, we can make it look a bit more like in the QGIS visualization that we saw before by running the following code:</p>
<div class="highlight"><pre><span></span><code>## alternative, nicer-looking plot

# open a new display window
x11()

# change plot settings to plot all four plots in one window using 3 rows and 2 columns
par(mfrow=c(2,3))

# prepare coloring
cuts=c(0,1,2,3,4,5) #set breaks
pal &lt;- colorRampPalette(c(&quot;darkgreen&quot;, &quot;blue&quot;, &quot;brown1&quot;, &quot;chartreuse2&quot;, &quot;darkgoldenrod1&quot;))

# plot the images
plot(s2_luc, breaks=cuts, col = pal(5), legend=F)
plot(ls_luc, breaks=cuts, col = pal(5), legend=F)
plot(mod250_luc, breaks=cuts, col = pal(5), legend=F)
plot(mod500_luc, breaks=cuts, col = pal(5), legend=F)
# plot dummy to include legend
plot(mod500_luc, col = &quot;white&quot;, axes=F, ann=F, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, box=F, legend=F)
#plot legend
legend(&quot;bottomleft&quot;, legend=c(&quot;Forest&quot;,&quot;Water&quot;,&quot;Urban&quot;,&quot;Grassland&quot;, &quot;Bare soil&quot;),fill=c(&quot;darkgreen&quot;, &quot;blue&quot;, &quot;brown1&quot;, &quot;chartreuse2&quot;, &quot;darkgoldenrod1&quot;))
</code></pre></div>
<p>This will look like this:</p>
<p><a class="glightbox" href="../assets/r_0_51.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/r_0_51.png" /></a></p>
<h2 id="step-3-calculate-landscape-metrics-for-the-entire-image">Step 3: Calculate landscape metrics for the entire image<a class="headerlink" href="#step-3-calculate-landscape-metrics-for-the-entire-image" title="Link zu dieser Sektion">&para;</a></h2>
<p>After successfully loading and plotting the images, we will now calculate the landscape metrics for each image. We will accomplish this using the SDMTools packages and the "ClassStat" and the "PatchStat" functions. The two functions only require the input raster (expected is a categorical raster file) and a user-defined cellsize, which in our case will be the spatial resolution of the corresponding satellite sensors. We can calculate the landscape metrics by running the following lines:</p>
<div class="highlight"><pre><span></span><code># calculate class-stats for each image
metr_s2 &lt;- ClassStat(s2_luc, cellsize=10)
metr_ls &lt;- ClassStat(ls_luc, cellsize=30)
metr_mod250 &lt;- ClassStat(mod250_luc, cellsize=250)
metr_mod500 &lt;- ClassStat(mod500_luc, cellsize=500)

# calculate patch-stats for each image
patch_s2 &lt;- PatchStat(s2_luc, cellsize=10)
patch_ls &lt;- PatchStat(ls_luc, cellsize=30)
patch_mod250 &lt;- PatchStat(mod250_luc, cellsize=250)
patch_mod500 &lt;- PatchStat(mod500_luc, cellsize=500)
</code></pre></div>
<p>This calculation may take a few seconds. Once they are ready, we will be able to have a look at the calculated metrics and also make some comparisons between the four land-cover maps.</p>
<p>First of all we are interested in what kind of metrics were calculated. To see the names and the definitions of the calculated metrics, we can have a look at the details of the applied functions by running the code:</p>
<div class="highlight"><pre><span></span><code>?ClassStat
?PatchStat
</code></pre></div>
<p>For simply seeing the names of the metrics, we can also run:</p>
<div class="highlight"><pre><span></span><code>colnames(metr_s2)
colnames(patch_s2)
</code></pre></div>
<p>Now, let us have a closer look on what has actually been calculated. If we simply run the objects that were created by calling the functions, we can see that all landscape metrics have been calculated for all of the five land-cover classes in the image. Running:</p>
<div class="highlight"><pre><span></span><code>metr_s2
</code></pre></div>
<p>will result in:</p>
<p><a class="glightbox" href="../assets/r_1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/r_1.png" /></a></p>
<p>Here, it becomes clear that for each class and landscape metric, a single value is given. Some of the metrics are quite easy to interprete such as "<strong>prop.landscape</strong>" which simply  indicates the fractional cover of the land-cover class in the complete image. Hence, in this case, the values of all five classes should add-up to 1.
For understanding also the other metrics, it is recommended to have a closer look at the details provided in the descriptions of the r-package and the citations given there.</p>
<p>We will now try to make some comparisons of values between the four input land-cover datasets with varying spatial resolution. To do this, we will create some bar plots. To get the plots, we first have to select which landscape metric we want to have a look at and then the land-cover class for which we want to compare the values:</p>
<div class="highlight"><pre><span></span><code>metric=10
luc_class=2
</code></pre></div>
<p>Remember, for getting the names of the calculated landscape metrics we can run:</p>
<div class="highlight"><pre><span></span><code>colnames(metr_s2)
</code></pre></div>
<p>If we want to know how the 10<sup>th</sup> calculated metric is called, we can also run:</p>
<div class="highlight"><pre><span></span><code>colnames(metr_sw)[10]
</code></pre></div>
<p>Now, lets plot some comparative barplots to always compare the values of landscape metric 10 (mean patch area) calculcated for land cover class 2 (water) of Landsat with the three other input datasets:</p>
<div class="highlight"><pre><span></span><code># selected metric and class
metric=10
luc_class = 2

# make plots
x11()
par(mfrow=c(1,3))
barplot(c(metr_ls[luc_class,metric], metr_s2[luc_class,metric]), xlab=&quot;Landsat vs. S2&quot;, main=paste0(colnames(metr_ls)[metric]), cex.axis=1.5, cex.lab = 1.5)
barplot(c(metr_ls[luc_class,metric], metr_mod250[luc_class,metric]), xlab=&quot;Landsat vs. MODIS 250 m&quot;, main=paste0(colnames(metr_ls)[metric]), cex.axis=1.5, cex.lab = 1.5)
barplot(c(metr_ls[luc_class,metric], metr_mod500[luc_class,metric]), xlab=&quot;Landsat vs. MODIS 500 m&quot;, main=paste0(colnames(metr_ls)[metric]), cex.axis=1.5, cex.lab = 1.5)
</code></pre></div>
<p>This will result in:</p>
<p><a class="glightbox" href="../assets/r_2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/r_2.png" /></a></p>
<p>We can see that even though we calculated the same metric, for the same class and the same landscape with the same extent, the differences in spatial resolution of the input datasets, leads to quite strong differences in mean patch area. The differences are stronger, the stronger the resolution differences are. However, this of course also depends on the applied metric and land-cover class. You can now try to make some more comparisons, by changing the variables <strong>metric</strong> and <strong>luc_class</strong> in the code and then re-run the plot command.</p>
<h2 id="step-4-calculate-landscape-metrics-for-a-grid">Step 4: Calculate landscape metrics for a grid<a class="headerlink" href="#step-4-calculate-landscape-metrics-for-a-grid" title="Link zu dieser Sektion">&para;</a></h2>
<p>So far, we calculated a single landscape metric for the whole land-cover map. In our case, the landscape is still comparably small in size so calculating a single metric for the whole landscape, may make sense for some applications. However, in many other cases, we might either have a larger landscape at hand or we might be interested to also see how our landscape varies in terms of its metrics at a finer spatial grain as compared to the complete landscape. In the following, we will adjust the code used above to calculate landscape metrics for smaller sub-parts of the land-cover maps.</p>
<p>This will require that we put the calculation into a loop and before running this loop we will have to create a  grid with a user-defined grid cell size. In the following, the code will be presented step by step. First we define the grid-cell size:</p>
<div class="highlight"><pre><span></span><code># define a tile size for which you want to compute the landscape metrics
tile_size &lt;- 500
</code></pre></div>
<p>In our case this would mean 500 m - but this will depend on the applied coordinate reference system. As we are using data in the metric UTM coordinate reference system, the 500 is fine. It would be more complicated when using the geographic coordinate system with Latitude and Longitude as in this case the grid cell size would have to be defined in geographic degrees. Next, we define the input dataset for which we want to create the grid and extract its extent. In this case, we will use the land-cover map derived from Sentinel-2</p>
<div class="highlight"><pre><span></span><code># define the land-use map you want to use as input
inp &lt;- s2_luc

# use extent of raster layer to prepare grid cells
# with the tile size defined above 
e &lt;- extent(inp)

# check what e looks like by running
e
</code></pre></div>
<p>This will result in the following:</p>
<p><a class="glightbox" href="../assets/r_3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/r_3.png" /></a></p>
<p>We can see that the variable e contains the outer margins of our input image with minimum and maximum x and y coordinates, respectively. From this, we will now derive the total width and height of the area the image is covering by running (the results will be in meter as we are in the metric coordinate system):</p>
<div class="highlight"><pre><span></span><code># get x and y ranges
x_ra &lt;- (e[2]-e[1]) 
y_ra &lt;- (e[4]-e[3])
</code></pre></div>
<p>Then we will set the grid-cell size by assigning the user-defined value from above to two variables, representing the x and y direction. The two variables will be required in the code below. Be aware that we in theory could also use non-quadratic grid cells, but for now, let's just stay with the quadratic cells.</p>
<div class="highlight"><pre><span></span><code># set x,y lengths of grid to user defined tile size
x_r &lt;- tile_size
y_r &lt;- tile_size
</code></pre></div>
<p>Now we are ready to run a nested for-loop to create the grid cell coordinates:</p>
<div class="highlight"><pre><span></span><code># create list to store the results of the tile coordinates
cases &lt;- list()

# create coordinates of all tiles
iter=1
for (i2 in 1:(floor(x_ra/x_r))) {
  for (i in 1:(floor(y_ra/y_r))) {

    e &lt;- extent(inp)
    e[1] &lt;- e[1] + (i2-1)*x_r
    e[2] &lt;- e[1] + x_r
    e[3] &lt;- e[3] + (i-1)*y_r
    e[4] &lt;- e[3] + y_r
    cases[[iter]] &lt;- c(e[1], e[2], e[3], e[4])
    iter = iter+1
  }
}

# unbind tile coordinate list
cases2 &lt;- do.call(rbind, cases)
# asign meaningful colnames
colnames(cases2) &lt;- c(&quot;xmin&quot;, &quot;xmax&quot;, &quot;ymin&quot;, &quot;ymax&quot;)
# check final coordinate list
head(cases2)
</code></pre></div>
<p>I will not get into details here about what this code is doing exactly, but feel free to explore the code a bit more. In short, this code will return a list of coordinate-sets defining the 500 m grid-cells for which we will calculate our landscape metrics. The last r command in the code <strong>head(cases2)</strong> will result in:</p>
<p><a class="glightbox" href="../assets/r_4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/r_4.png" /></a></p>
<p>So you can see that each row in the "<strong>cases2</strong>"-variable has the same structure as the "<strong>e</strong>" variable from above and basically describes the outer margin of a single grid-cell.</p>
<p>OK! Now let's calculate the metrics for the grid. In the following, we will run the code in a parallelized script. This will enable a notably faster processing time, if the computer has more than one cpu/core available. To do this, we only have to change some parts of the code in comparison to a normal for-loop. Again, I will not go into details here, but in case you are interested in how this works exactly, you can get some first information here:</p>
<p><a href="https://cran.r-project.org/web/packages/doParallel/vignettes/gettingstartedParallel.pdf" title="Parallel processing">https://cran.r-project.org/web/packages/doParallel/vignettes/gettingstartedParallel.pdf</a></p>
<p>Now, let us have a look at the code. First, we start the process by initalizing the parallel processing:</p>
<div class="highlight"><pre><span></span><code>#setup parallel backend to use more than one processors

# define number of cores (you can switch the value to a higher numer of your computer has more cores)
# for checking how many cores your computer has you can run: detectCores()
ncors=2
cl&lt;-makeCluster(ncors)
registerDoParallel(cl)

# get timestamp to see how long the process takes
print(timestamp())
</code></pre></div>
<p>At this point the pure processing part begins. The processing is devided into four steps. First, the extent of the i-th grid cell is defined by taking the i-th row from the variable <strong>cases2</strong> created above. Second, the raster image is clipped with the extent. Third, landscape metrics are caclulated for the clipped raster-subset. Fourth, all metrics are merged into a single variable <strong>cstat2</strong> and center coordinates of the current grid cell are added to this variable (to allow for copying the information back to a raster later on). This variable is then returned and the next iteration is started:</p>
<div class="highlight"><pre><span></span><code>rs &lt;- foreach(i=1:length(cases2[,1]), .packages=c(&quot;raster&quot;, &quot;SDMTools&quot;)) %dopar% {

  # create an extent file using the coordinates from the coordinate list
  e2 &lt;- extent(cases2[i,1], cases2[i,2], cases2[i,3], cases2[i,4])
  # crop the large image to the tile
  img &lt;- crop(inp, e2)

  # calculate landscape metrics for the file
  cstat &lt;- ClassStat(img, cellsize = 10)
  cstat1 &lt;- PatchStat(img, cellsize = 10)

  cstat2 &lt;- cbind(cstat, cstat1)

  # transform results to dataframe
  cstat2 &lt;- as.data.frame(cstat2)

  # attach mean x and y coordinates to the results for comfortable plotting afterwards
  x_mean &lt;- (cases2[i,1] + cases2[i,2])/2
  y_mean &lt;- (cases2[i,3] + cases2[i,4])/2

  cstat2$xm &lt;- rep(x_mean, length(cstat2[,1]))
  cstat2$ym &lt;- rep(y_mean, length(cstat2[,1]))

  #patch

  #return final dataframe to store in list
  cstat2

}

# stop parallel processing
stopCluster(cl)

#get another timestamp to see how long it tood
print(timestamp())
</code></pre></div>
<p>After landscape metrics have been calculated for all grid cells, the raw output data has to be further processed to transfer them back into raster files. The result of the for-loop described above are stored in a variable called "<strong>rs</strong>" which is in the list-format of R. As first step, we transfer this list into a dataframe by applying the rbind-function to all entries in the list:</p>
<div class="highlight"><pre><span></span><code># check first results
head(rs)
# bind all results to have one large dataframe
rs_fin &lt;- do.call(rbind, rs)

#check final results
head(rs_fin)
</code></pre></div>
<p>This results in:</p>
<p><a class="glightbox" href="../assets/r_5.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/r_5.png" /></a></p>
<p>Next, we extract one of the landscape metrics for one of the five examined land-cover classes and save it as a raster file. In theory all calculated metrics could be saved using the same procedure with some small adaptations to the code. In the code below we select the landcover class 1 which is forest. Details are provided in the comments to the code.</p>
<div class="highlight"><pre><span></span><code>##################################################
## start postprocessing results
##################################################

## extract number of patches for yth land-use class

dev.off()

# select land-cover class (1 = forest)
luc_class=1

# subset the overall results to only keep values of the selected land-cover class
rs_fin_cl &lt;- rs_fin[rs_fin$class==luc_class,]

# check the available metrics
colnames(rs_fin_cl)

# select one metric - in this case metric 4 which is the percentage cover of the target class
# in a given grid cell 
metric = 4

# prepare map of percentage cover of forest
# to do this, first build a table including the center coordinates of each grid cell
# and the selected metric
inp_ras &lt;- cbind(rs_fin_cl$xm, rs_fin_cl$ym, rs_fin_cl[,metric])

# then use the rasterfromXZY-function to create a raster file
dfr &lt;- rasterFromXYZ(inp_ras)

# copy the coordinate reference system information to transfer the raster to a
# raster with geoinformation
crs(dfr) &lt;- crs(ls_luc)

# plot the map
plot(dfr, main=colnames(rs_fin_cl)[metric])

# save result to tiff-file that can be opened in QGIS
writeRaster(dfr, &quot;prop_forest_area.tif&quot;, format=&quot;GTiff&quot;, overwrite=T)
</code></pre></div>
<p>We have now calculated a first landscape metric-map in R. We can check our results by loading the just created prop_forest_area.tif file into our QGIS project from the start of the tutorial. If we now compare the land-cover map with the percentage cover raster we calculated (depicted below after adapting the visualization settings), we can see that the results seem plausible. Grid cells covered only by forest have a 100% cover (value of 1) while areas with only smaller fractions of forest, show the corresponding values:</p>
<p><a class="glightbox" href="../assets/qgis_3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/qgis_3.png" /></a>
<a class="glightbox" href="../assets/qgis_4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../assets/qgis_4.png" /></a></p>
<p>You can see in the QGIS project that the current processing flow is not yet perfect, as we are losing a small part of the image edges (the created raster does not have exactly the same size as the input image). This is not fully solvable as long as the x- and y-ranges of the input image are not evenly dividable by the selected grid cell size. Related problems have been discussed in the theoretical part of today's course session. </p>
<p>So you have now learned all the processing steps required to calculate landscape metrics from a land-cover map in R. For training and better understanding the code, I would recommend to adjust the code above a bit to calculate some more landscape metrics and also compare metrics amongst the different input-datasets with varying spatial resolution. In next week's practical exercise you will have to use the work-flow learned here, to solve a small ecological question.</p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../BFAST/BFAST/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Analysing time series with BFAST and NPPHEN" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Analysing time series with BFAST and NPPHEN
              </div>
            </div>
          </a>
        
        
          
          <a href="../../spatial_autocorrelation/spatial_autocorrelation/" class="md-footer__link md-footer__link--next" aria-label="Next: Calculating semivariograms and Autocorrelograms" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Calculating semivariograms and Autocorrelograms
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; CC-BY-SA-4.0 license - Freie Universitt Berlin Institute of Geographical Sciences Remote Sensing and Geoinformatics
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate", "search.suggest", "search.highlight", "content.action.edit", "content.code.copy", "navigation.tracking", "navigation.tabs", "navigation.path", "navigation.top", "navigation.footer", "navigation.instant"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>